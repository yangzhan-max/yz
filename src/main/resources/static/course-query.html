<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>学生课表查询</title>
    <!-- Standard -->
    <link rel="shortcut icon" href="/logo/logo_title.png">
    <!-- Styles -->
    <link href="assets/fontAwesome/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="assets/css/lib/themify-icons.css" rel="stylesheet">
    <link href="assets/css/lib/mmc-chat.css" rel="stylesheet"/>
    <link href="assets/css/lib/sidebar.css" rel="stylesheet">
    <link href="assets/css/lib/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/lib/nixon.css" rel="stylesheet">
    <link href="assets/lib/lobipanel/css/lobipanel.min.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
</head>
<body>
<!--left-->
<div class="sidebar sidebar-hide-to-small sidebar-shrink sidebar-gestures">
    <div class="nano">
        <div class="nano-content">
            <ul>
                <li>
                    <a href="index.html"><i class="ti-user"></i> 个人主页</a></li>
                <li>
                    <a class="sidebar-sub-toggle"><i class="ti-clipboard"></i> 报名申请 <span
                            class="sidebar-collapse-icon ti-angle-down"></span></a>
                    <ul>
                        <li><a href="sign-levelExam.html">考级项目报名</a></li>
                        <li><a href="sign-teaching.html">教学项目报名</a></li>
                        <li><a href="sign-makeUp.html">补考确认</a></li>
                        <li><a href="sign-finalMakeUp.html">毕业补考报名</a></li>
                    </ul>
                </li>
                <li>
                    <a class="sidebar-sub-toggle"><i class="ti-write"></i> 信息维护<span
                            class="sidebar-collapse-icon ti-angle-down"></span></a>
                    <ul>
                        <li><a href="preserve-personalInfo.html">学生信息维护</a></li>
                        <li><a href="preserve-cultivate.html">个人培养方案</a></li>
                        <li><a href="preserve-credit.html">创新创业学分确认</a></li>
                    </ul>
                </li>
                <li class="active open">
                    <a class="sidebar-sub-toggle"><i class="ti-book"></i> 课程相关 <span
                            class="sidebar-collapse-icon ti-angle-down"></span></a>
                    <ul>
                        <li class="active"><a href="course-query.html">学生课表查询</a></li>
                        <li><a href="course-choose.html">自主选课</a></li>
                        <li><a href="course-exam.html">考试安排</a></li>
                    </ul>
                </li>
                <li>
                    <a class="sidebar-sub-toggle"><i class="ti-search"></i> 信息查询<span
                            class="sidebar-collapse-icon ti-angle-down"></span></a>
                    <ul>
                        <li><a href="info-warning.html">学籍预警查询</a></li>
                        <li><a href="info-graduationAudit.html">毕业审核查询</a></li>

                        <li><a href="info-score.html">学生成绩查询</a></li>


                    </ul>
                </li>
                <li><a target="_blank" href="evaluate.html"><i class="ti-comment-alt"></i> 教学评价</a></li>
            </ul>
        </div>
    </div>
</div>
<!-- header -->
<div class="header">
    <div class="pull-left">
        <div class="logo login-logo">
            <a href="index.html">
                    <span class="label label-primary">
                     教务管理系统
                    </span>
            </a>
        </div>
        <div class="hamburger sidebar-toggle">
            <span class="ti-menu"></span>
        </div>
    </div>
    <div class="pull-right p-r-15">
        <ul>
            <li class="header-icon dib">
                <img class="avatar-img" alt=""/>
                <span class="user-avatar">
                    <i class="ti-angle-down f-s-10"></i>
                </span>
                <div class="drop-down dropdown-profile">
                    <div class="dropdown-content-body">
                        <ul>
                            <li><a href="reset.html"><i class="ti-lock"></i> <span>修改密码</span></a></li>
                            <li><a href="new-email.html"><i class="ti-email"></i> <span>修改邮箱</span></a></li>
                            <li><a href="javascript:void (0)" onclick="exit()"><i class="ti-power-off"></i>
                                <span>安全退出</span></a></li>
                        </ul>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<!--content-->
<div class="content-wrap">
    <div class="main">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-8 p-0">
                    <div class="page-header">
                        <div class="page-title">
                            <h1><strong>课表查询</strong></h1>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 p-0">
                    <div class="page-header">
                        <div class="page-title">
                            <ol class="breadcrumb text-right">
                                <li><a>课程相关</a></li>
                                <li class="active">课表查询</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="main-content">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card alert">
                            <div class="card-header">
                                <div id="isEmpty"></div>
                                <h4>学生课表查询</h4>
                            </div>
                            <div class="card-body">
                                <div class="form-group col-lg-6">
                                    <label class="control-label">学年</label>
                                    <div id="school-year">
                                        <select class="form-control">
                                            <option>2019-2020</option>
                                            <option>2018-2019</option>
                                            <option>2017-2018</option>
                                            <option>2016-2017</option>
                                            <option>2015-2016</option>
                                            <option>2014-2015</option>
                                            <option>2013-2014</option>
                                            <option>2012-2013</option>
                                            <option>2011-2012</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group col-lg-6">
                                    <label class="control-label">学期</label>
                                    <div id="school-term">
                                        <select class="form-control">
                                            <option>1</option>
                                            <option>2</option>
                                        </select>
                                    </div>
                                </div>
                                <button type="button" id="search" onclick="courseAjax()"
                                        class="btn btn-primary m-r-15 m-b-10"
                                        style="float: right;">查询
                                    <span class="ti-search"></span>
                                </button>
                                <table class="table table-responsive table-bordered " style="text-align: center">
                                    <thead>
                                    <tr>
                                        <th>时间段</th>
                                        <th>节次</th>
                                        <th>星期一</th>
                                        <th>星期二</th>
                                        <th>星期三</th>
                                        <th>星期四</th>
                                        <th>星期五</th>
                                        <th>星期六</th>
                                        <th>星期日</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <th scope="row" rowspan="4" style="text-align: center;line-height: 175px;">
                                            上午
                                        </th>
                                        <th>1</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>2</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>3</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>4</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th scope="row" rowspan="4" style="text-align: center;line-height: 175px;">
                                            下午
                                        </th>
                                        <th>5</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>6</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>7</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>8</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th scope="row" rowspan="4" style="text-align: center;line-height: 175px;">
                                            晚上
                                        </th>
                                        <th>9</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>10</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>11</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <th>12</th>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<script src="assets/js/lib/jquery.min.js"></script>
<script src="assets/js/lib/jquery.nanoscroller.min.js"></script>
<script src="assets/js/lib/sidebar.js"></script>
<script src="assets/js/lib/bootstrap.min.js"></script>
<script src="assets/js/lib/mmc-common.js"></script>
<script src="assets/js/lib/datamap/d3.min.js"></script>
<script src="assets/js/lib/datamap/topojson.js"></script>
<script src="assets/lib/lobipanel/js/lobipanel.js"></script>
<script src="assets/js/scripts.js"></script>

<script src="js/public.js"></script>
<script>
    $(document).ready(courseAjax());
    // //查询课表
    // $('#search').click(courseAjax());
    //课表信息获取
    function courseAjax() {
        $('#isEmpty').removeClass("alert alert-info").html("");
        $('td').removeAttr("rowspan style").html("");
        let jsonData = {
            "courseYear": $('#school-year option:selected').val(),
            "courseTerm": $('#school-term option:selected').val()
        };
        $.ajax({
            url: '/course/show-course',
            type: 'post',
            data: JSON.stringify(jsonData),
            dataType: 'json',
            contentType: 'application/json;charset=UTF-8',
            success: function (result) {
                let data = result.data;
                if (data.length === 0) {
                    $('#isEmpty').addClass("alert alert-info").html('<strong>提示:</strong>（当前学年学期:' + timeJsonData().courseYear + '-' + timeJsonData().courseTerm + '）\n' +
                        '<strong>课表信息暂未公布，请联系管理员！</strong>');
                    $('tbody td').html("");
                    return;
                }
                //遍历数据集合
                for (let i = 0; i < data.length; i++) {
                    //表格内容
                    let innerHtml = "<td rowspan=\"2\">" + data[i].courseName + "&nbsp;" +
                        data[i].courseSection + "&nbsp（" + data[i].courseCycle + "）" +
                        "<br/>讲师：" + data[i].courseTeacher +
                        "<br/>新技术学院 &nbsp" + data[i].coursePlace +
                        "</td>";
                    //获取每一行的索引
                    $('table tr:eq(' + (tsforSection(data[i].courseSection) * 2 - 1) + ')').each(function () {
                        //获取每一列的索引
                        $(this).find('td:eq(' + (tsforWeek(data[i].courseWeek) - 1) + ')').replaceWith(innerHtml);

                    });
                    //去除多余的td
                    $('table tr:eq(' + (tsforSection(data[i].courseSection) * 2) + ')').each(function () {

                        $(this).find('td:eq(' + (tsforWeek(data[i].courseWeek) - 1) + ')').hide();
                    })
                }
            }
        })
    }

    //课程周次数据转换
    function tsforWeek(arg) {
        let courseWeek = null;
        switch (arg) {
            case "星期一":
                courseWeek = 1;
                break;
            case "星期二":
                courseWeek = 2;
                break;
            case "星期三":
                courseWeek = 3;
                break;
            case "星期四":
                courseWeek = 4;
                break;
            case "星期五":
                courseWeek = 5;
                break;
            case "星期六":
                courseWeek = 6;
                break;
            case "星期天":
                courseWeek = 7;
                break;
            default:
                courseWeek = null;
        }
        return courseWeek;
    }

    //课程节次数据转换
    function tsforSection(arg) {
        let courseSection = null;
        switch (arg) {
            case "1-2节":
                courseSection = 1;
                break;
            case "3-4节":
                courseSection = 2;
                break;
            case "5-6节":
                courseSection = 3;
                break;
            case "7-8节":
                courseSection = 4;
                break;
            case "9-10节":
                courseSection = 5;
                break;
            case "11-12节":
                courseSection = 6;
                break;
            case "13-14节":
                courseSection = 7;
                break;
            default:
                courseSection = null;
        }
        return courseSection;
    }

</script>
</body>
</html>